!function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=146)}({146:function(e,t,r){e.exports=r(147)},147:function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}jQuery((function(e){var t="before",i="US $";(function(){Handlebars.registerHelper("format_price",(function(e,r){e=parseFloat(e);var a=r.hash.decimalLength||2,n=r.hash.thousandsSep||",",o=r.hash.decimalSep||".",s="\\d(?=(\\d{3})+"+(a>0?"\\D":"$")+")",c=e.toFixed(Math.max(0,~~a)),d=(o?c.replace(".",o):c).replace(new RegExp(s,"g"),"$&"+n);return"before"===t?i+""+d:d+""+i})),Handlebars.registerHelper("stars",(function(e){for(var t="",r=e.toString().split("."),i=!1,a=1;a<=5;a++)r[0]>=a?t+='<i class="fa fa-star"></i>':i?t+='<i class="fa fa-star-o"></i>':(i=!0,r[1]>7?t+='<i class="fa fa-star"></i>':r[1]<3?t+='<i class="fa fa-star-o"></i>':r[1]>=3&&r[1]<=7?t+='<i class="fa fa-star-half-o"></i>':t+='<i class="fa fa-star-o"></i>');return t}))})();var a=!1;(function(){var t=null;function i(t,i,a){i=""!==i&&"object"===r(i)?window.ADS.serialize(i):i,e.ajaxQueue({url:ajaxurl,data:{action:"adsw_action_reviews",ads_action:t,args:i},type:"POST",dataType:"json",success:a})}function n(){if(e("#ads_review-form .js-select-cat").hide(),"categories"==e('#ads_review-form [name="prod_type"]').val()){var t=[];e("option:selected","#ads_review-form .js-select-cat").each((function(){t.push(e(this).val())})),e('#ads_review-form [name="applyto"]').val(t.join()),e("#ads_review-form .js-select-cat").show()}e("#apply_min").toggle(e("#apply_empty").is(":checked")),parseInt(e("#apply_min").val())<1&&e("#apply_min").val(1)}function o(t){var r=e("#ali-review").html(),i=e("#ads_review-form");if(t)if(t.hasOwnProperty("error"))window.ADS.notify(t.error,"danger");else{i.html(window.ADS.objTotmpl(r,t)),setTimeout(window.ADS.switchery(i),300);var a=parseInt(e("#total_item").val()),o=parseInt(e("#current_item").val());o>0&&a>0&&window.ADS.progressText(e(".progress-head"),a,o);var s=e('#ads_review-form [name="applyto"]').val();s=s?s.split(","):[],e("#ads_review-form .js-select-cat").find('[multiple="multiple"]').multiselect("select",s),n(),e.event.trigger({type:"request:done",obj:"#ads_review-form"})}}function s(t,r){if(void 0===r)return!1;var i=function(t){var r=t.split("?"),i=r[0],a=r[1].split("&"),n={};return e.each(a,(function(e,t){var r=t.split("=");n[r[0]]=r[1]})),{hostName:i,urlArray:n}}(t);return e.each(r,(function(e,t){i.urlArray[e]=t})),function(t,r){var i=t+"?",a=[];return e.each(r,(function(e,t){void 0===t&&(t=""),a.push(e+"="+t)})),i+=a.join("&")}(i.hostName,i.urlArray)}function c(t){var r=t.post_id,i=e("#ads_activities-list").find('[data-post_id="'+r+'"]'),a=e("#ads_activities-list").find('[data-post_id="'+r+'"] .count-reviews'),n=t.product_id,o=t.productUrl,s=parseInt(a.text())+t.count;a.text(s),s<t.count_review&&t.page<30?u(t.page,r,t.feedbackUrl,n,o):(i.find(".loader-action").hide(),i.find(".loader-done").show(),f(!1))}function d(t){var r=t.index.params,i=t.index.reviews||[],a=t.obj,n=r.post_id,o=r.product_id,s=r.productUrl,d=r,l={flag:"",author:"",star:"",feedback:"",date:""},u=e("#ads_activities-list").find('[data-post_id="'+n+'"] .count-reviews').text();u=parseInt(u);var p=[];a&&a.find(".feedback-list-wrap .feedback-item").each((function(t,r){var a,n,o=[];(l={}).feedback=e(this).find(".buyer-feedback").text(),e(this).find(".buyer-feedback .r-time-new").length&&(l.feedback=e(this).find(".buyer-feedback span:not(.r-time-new)").text()),l.feedback=l.feedback.replace("seller","store"),l.flag=e(this).find(".css_flag").text(),l.author=e(this).find(".user-name").text(),l.star=(a=e(this).find(".star-view span").attr("style"),n=0,(a=parseInt(a.replace(/[^0-9]/g,"")))>0&&(n=parseInt(5*a/100)),n),e(this).find(".pic-view-item").each((function(t,r){o.push(e(r).data("src"))}));var s=e(this).find(".r-time");e(this).find(".r-time-new").length&&(s=e(this).find(".r-time-new")),l.date=s.text(),l.images=o,i.push(l)}));for(var w in i)p.push(i[w]);0!==i.length&&u<=d.countReviews?function(t,r,i){e.ajaxQueue({url:ajaxurl,data:{action:"adsw_action_reviews",ads_action:t,args:r},type:"POST",dataType:"json",success:i})}("upload_review",{post_id:n,product_id:o,productUrl:s,feed_list:ADS.b64EncodeUnicode(JSON.stringify(p)),min_star:d.min_star,withPictures:d.withPictures,uploadImages:d.uploadImages,ignoreImages:d.ignoreImages,importedReview:u,page:d.page++,feedbackUrl:d.feedbackUrl,count_review:e("#count_review").val(),approved:d.approved,select_country:JSON.stringify(d.select_country),skip_keywords:d.skip_keywords,select_translate:d.select_translate},c):f(!1)}function l(t){var r=e(".progress-head");if(t.hasOwnProperty("error"))window.ADS.notify(t.error,"danger"),window.ADS.btnUnLock(a),a=!1;else if(t.hasOwnProperty("message"))window.ADS.notify(t.message,"success"),window.ADS.progressText(r,10,10),window.ADS.btnUnLock(a),a=!1;else{var i=e("#item-review-template").html(),n=e("#ads_activities-list");n.find(".table-products").length||n.html(e("<div/>",{class:"table-products"})),n=n.find(".table-products"),window.ADS.progressText(r,t.total,t.current);var o=n.find(".review-item");if(o.length>=15&&o.last().remove(),n.find(".loader-action").hide(),n.find(".loader-done").show(),n.prepend(window.ADS.objTotmpl(i,t.row)),n.find("div:first").find(".loader-action").show(),e("#current_item").val(t.current),t.row.productUrl)t.row.productUrl&&u(1,t.row.post_id,!1,t.row.product_id,t.row.productUrl);else f()}}function u(r,i,a,n,o){e("#ads_activities-list").find('[data-post_id="'+i+'"]').find(".loader-action").show();var c=e("#select_translate").val(),l={rate:e("#min_star").val(),countReviews:e("#count_review").val(),translate:"none"===c?"+N+":"+Y+",ignoreImages:e("#ignoreImages").is(":checked"),withPictures:e("#withImage").is(":checked"),uploadImages:e("#uploadImage").is(":checked"),approved:e("#approved").is(":checked"),skip_keywords:e("#skip_keywords").val(),select_translate:c,select_country:e("#select_country").val()},u=a&&"false"!==a?s(a,{translate:l.translate,page:r,withPictures:l.withPictures}):"",f={post_id:i,product_id:n,productUrl:o,page:r,feedbackUrl:a,countReviews:l.countReviews,withPictures:l.withPictures,uploadImages:l.uploadImages,ignoreImages:l.ignoreImages,min_star:l.rate,approved:l.approved,skip_keywords:l.skip_keywords,select_translate:l.select_translate,select_country:l.select_country};if(o){var w=[];window.ADS.aliExtension.sendAliExtension("getReviewsProduct",{productid:n,page:r,product_url:o}).then((function(e){var t=e.reviewInfo.reviews;for(var r in t){var i=t[r];w.push({feedback:i.text,flag:i.country.toUpperCase(),author:i.username,star:i.rating,date:p(i.date),images:i.gallery})}d({obj:null,index:{params:f,reviews:w}})}))}else setTimeout((function(){window.ADS.aliExtension.addTask(u,d,t,{params:f})}),2e3)}function p(e){if(!e.match(/(\d+) (\W+) (\d+) (\d+):(\d+)/im))return e;var t={"янв":"01","фев":"02","мар":"03","апр":"04","май":"05","июн":"06","июл":"07","авг":"08","сен":"09","окт":"10","ноя":"11","дек":"12"},r=e.match(/(\d+) (\W+) (\d+) (\d+):(\d+)/im),i=t.findIndex((function(e){return e===r[2]}));return r[0].replace(r[2],t[i])}function f(t){var r=t?"first_review":"next_review";e("#product-list").show(),i(r,e("#ads_review-form"),l)}return{init:function(){t=this,window.ADS.aliExtension.sleepTask(1),window.ADS.aliExtension.enableAjax(),i("review_form","",o),e(document).on("click","#js-reviewImport",(function(t){t.preventDefault(),e("#js-reviewNext").remove(),a=e(this),window.ADS.btnLock(a),e("#current_item").val(0),e("#ads_activities-list").html(""),window.ADS.progressText(e(".progress-head"),0,0),f(!0)})),e(document).on("click","#js-reviewNext",(function(t){t.preventDefault(),e(this).remove(),a=e("#js-reviewImport"),e("#ads_activities-list").html("");var r=parseInt(e("#total_item").val()),i=parseInt(e("#current_item").val());i>0&&r>0&&window.ADS.progressText(e(".progress-head"),r,i),window.ADS.btnLock(a),f(!1)})),e(document).on("request:done",(function(t){"#ads_review-form"===t.obj&&function(){if(e(document).find("#ignoreImages").is(":checked")){var t=e("#withImage"),r=t.parents(".checkbox-switchery"),i=e("#uploadImage"),a=i.parents(".checkbox-switchery");t.prop("checked")&&t.click(),i.prop("checked")&&i.click(),r.hide(),a.hide()}}()})),e(document).on("click","#ignoreImages",(function(){var t=e("#ads_review-form"),r=t.find("#withImage"),i=r.parents(".checkbox-switchery"),a=t.find("#uploadImage"),n=a.parents(".checkbox-switchery");e(this).is(":checked")?(r.prop("checked")&&r.click(),a.prop("checked")&&a.click(),i.hide(),n.hide()):(i.show(),n.show())})),e(document).on("change",'#ads_review-form [name="prod_type"]',(function(){e('#ads_review-form [name="applyto"]').val(""),n()})),e(document).on("change","#ads_review-form .js-select-cat",(function(){n()})),e(document).on("change",'#ads_review-form [name="apply_empty"]',(function(){n()})),e(document).on("change","#ads_review-form #apply_min",(function(){n()}))}}})().init()}))}});